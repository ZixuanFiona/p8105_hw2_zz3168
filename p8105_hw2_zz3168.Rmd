---
title: "p8105_hw2_zz3168"
author: "Zixuan Zhang"
date: "2023-10-02"
output: github_document
---

### Problem 0

```{r}
library(tidyverse)
library(readxl)
```

### Problem 1
```{r clean_538_plots}
month_df = tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )
 
pols = 
  read_csv("data/pols-month.csv") |> 
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE) |> 
  mutate(president = recode(prez_gop, "0" = "dem","1" = "gop", "2" ="gop" )) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -day, -starts_with("prez"))
  
  
```

We also clean the 538 `snp` data, which contains information related to Standard & Poorâ€™s stock market index.

```{r clean_538_snp}
snp = 
  read_csv("data/snp.csv") |> 
  separate(date, into = c("month", "day", "year"), convert = TRUE) |> 
  arrange(year, month) |> 
  mutate(month = month.name[month]) |>
  select(year, month, close)
  
```

we tidy the `unemployment` data so that it can be merged with the `pols` and `snp` datasets.
```{r clean_538_unemp}
unemployment = 
  read_csv("data/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec,
    names_to = "month_abb",
    values_to = "unemployment") |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)
  
```

we merge the three datasets

```{r merge_538}
data_problem1 =
  left_join(pols, snp) |> 
  left_join(x = _, y = unemployment)

str(data_problem1)
```
There are some `NA` values in the `close` and `unemployment` variables, which indicate that the value of these variables are missing at those locations.

In the 538 datasets, the `pols` data has `r ncol(pols)` variables and `r nrow(pols)` observations. 

### Problem 2

```{r}
mr_trash_wheel =
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Mr. Trash Wheel",
             range = "A2:N549") |> 
  janitor::clean_names() |> 
  mutate(
    homes_powered = weight_tons * 500/30,
    mr_trash_wheel = "Mr. Trash Wheel",
    year = as.numeric(year)
    )

pr_trash_wheel =
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Professor Trash Wheel",
             range = "A2:M108") |> 
  janitor::clean_names() |> 
  mutate(homes_powered = weight_tons * 500/30,
          mr_trash_wheel = "Professor Trash Wheel"
        )

gwynnda_trash_wheel =
  read_excel("data/202309 Trash Wheel Collection Data.xlsx", 
             sheet = "Gwynnda Trash Wheel",
             range = "A2:L157") |> 
  janitor::clean_names() |> 
  mutate(homes_powered = weight_tons * 500/30,
         mr_trash_wheel = "Gwynnda Trash Wheel"
        
         )
```

#combine the data

```{r}
combine_data =
  bind_rows(mr_trash_wheel, pr_trash_wheel, gwynnda_trash_wheel)

```




### Problme 3 
```{r}
baseline_data =
  read_csv("data/data_mci/MCI_baseline.csv") |> 
  janitor::clean_names() |> 
  mutate(
    sex = 
      case_match(
        sex, 
        1 ~ "male", 
        2 ~ "female"),
    sex = as.factor(sex),
    apoe4 = 
      

  
  
  
   


```

